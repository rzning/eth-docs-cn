# 以太坊是什么 - 以太坊开发入门指南

- <https://learnblockchain.cn/2017/11/20/whatiseth/>

## 以太坊是什么

- 以太坊（Ethereum）是一个建立在区块链技术之上， 去中心化应用平台。

- 它允许任何人在平台中建立和使用通过区块链技术运行的去中心化应用。

## 智能合约

- 在以太坊网络上运行的程序称之为智能合约（Smart Contract）。

- 和其他程序一样，它也是代码和数据（状态）的集合。

- 比特币的交易也是可以编程的，但是比特币脚本有很多限制，能够编写的程序也十分有限。

- 智能合约是“图灵完备”的，因此理论上我们可以用来编写任何需求的程序。

- 智能合约非常适合对信任、安全和持久性要求比较高的应用场景。

- 比如：数字货币、数字资产、投票、金融应用、产权所有权管理、物联网、点对点交易等。

### 编程语言： Solidity

- 以太坊智能合约开发语言有：
  - Solidity : 受 JavaScript 启发。
  - Serpent : 受 Python 启发。
  - Mutan : 受 Go 启发。
  - LLL ( Lisp Like Language ) : 受 Lisp 启发。

- Solidity 是一门编译型语言。

- Solidity 是静态类型语言，支持继承、库和复杂的用户定义类型。

### 运行环境： EVM

- EVM（Ethereum Virtual Machine）以太坊虚拟机：提供智能合约的运行环境。

- EVM 用来执行以太坊上的交易。

- EVM 运行在以太坊节点上。

### 合约的编译

- 在部署之前，需要将智能合约编译为字节码，才能在 EVM 上运行。

- 可以使用 Remix 或 solc 编译。

### 以太坊客户端

- 以太坊客户端（钱包）提供账户管理、挖矿、转账、智能合约的部署和执行等功能。

- EVM 是由以太坊客户端提供的。

- Geth 是基于 Go 语言开发的以太坊客户端，提供了一个交互式命令控制台。

### 合约的部署

- 智能合约的部署指的是把合约字节码发布到区块链上，并使用一个特定的地址来标记这个合约。

- 用来标记智能合约的地址成为合约账户。

- 以太坊中存在两类账户：
  - 外部账户 ：被私钥（由人）控制，不关联任何代码。
  - 合约账户 ：由智能合约控制，并由代码与之关联。

- 此两类账户对于 EVM 来说是一样的，没有本质区别。

- 一个外部账户可以使用自己的私钥对交易进行签名，并发送消息给另一个外部账户或合约账户。

- 只有外部账户发出指令时，合约账户才会执行相应的代码操作。

- 合约部署就是将编译好的合约字节码通过外部账号发送交易的形式部署到以太坊区块链上。

- 由实际矿工出块之后，才真正部署成功。

### 运行合约

- 合约部署成功之后，当需要调用这个智能合约的方法时，只需向这个合约账户发送消息（交易）即可。

> - 智能合约是部署在区块链上的代码，区块链本身不执行代码。
> - 智能合约代码是在本地 EVM 客户端中执行的。
> - 若将区块链看作一个数据库，客户端需要从数据库中读取存储的代码，并在本地运行，
>   智能合约代码执行后还需要将结果写入到区块链（数据库）中。

### Gas

- 以太坊使用 Gas 机制来计费，可以把 Gas 看作是一个工作量单位。

- 智能合约越复杂，执行所耗费的 Gas 就越多。

- 调用特定的智能合约所需的 Gas 数量是恒定的，有合约的复杂度决定。

- Gas 价格由运行合约的人在提交运行合约请求时指定，以确定他愿意为此次交易付出的费用。

- Gas 费用 = Gas 价格 * Gas 数量

- 当 EVM 执行交易时， Gas 将按照特定的规则被逐渐消耗。

- 无论执行到什么位置，一旦 Gas 被耗尽，将触发异常，当前调用帧所作的所有状态修改都将回滚。

- 如果执行结束 Gas 还有剩余，将返还给发送用户。

> - 若没有这个限制，就可能有人写出无法停止的（如死循环）的合约来阻塞网路。

- 实际上，我们需要一个有以太币余额的外部账户来发起一个交易，运行合约，矿工收取相应的工作量费用。

## 以太坊网路

没有以太币，可以使用下面方式进行智能合约开发：

- 使用以太坊官方测试网路 Testnet

- 使用私有链

- 使用开发者网路（模式）

- 使用模拟环境

## DApp : 去中心化应用程序

- 以太坊社区将基于智能合约的应用成为去中心化应用程序 ( Decentralized App ) 。

- Truffle 是一个流行的 DApp 开发框架。

## 总结

- 以太坊是一个平台，它让我们方便的使用区块链技术开发去中心化的应用。

- 使用 Solidity 来编写和区块链交互的智能合约。

- 合约编写好后之后，我们需要用以太坊客户端用一个有余额的账户去部署及运行合约。

- 为方便开发，可以使用 Geth 或 Ganache 搭建一个测试网路。
